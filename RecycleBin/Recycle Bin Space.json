{"blocks":[{"id":"BB636FB9-18D5-4FE3-A2AD-ECC3FE789D90","type":"StartBlock","disabled":false,"name":"Start","displayName":"Start","comment":"","childId":"E6E8C2C3-ECFE-47D6-9A67-96CB47F533F5","inputs":[{"id":"run_mode","value":"manual","type":"select","structure":{}}],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-198,"y":2},{"id":"85ADC559-CC8F-40BD-9859-8C3A490A4907","type":"SnippetBlock","disabled":false,"name":"ListItemsByTagName","displayName":"Qlik Platform Operations - List Items By Tag Name","comment":"Get all Items marked for deletion","childId":"B663DC06-DA59-494D-89F8-87A22EA97F96","inputs":[{"id":"d9537880-4e7a-11ef-8c18-9fc2d21e7949","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"d953e570-4e7a-11ef-997a-8b9e123a0498","value":"delete","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-203,"y":780,"loopBlockId":"EBF34D0D-926C-482D-8F67-B36309FD6897","datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","snippet_guid":"d94e7510-4e7a-11ef-9914-3d4e35005960"},{"id":"9016BD7C-5315-4098-B53C-EE0C2A76C0DA","type":"EndpointBlock","disabled":false,"name":"moveApp","displayName":"Qlik Platform Operations - Move App","comment":"Move App for Deletion","childId":"F520A5F5-5966-443F-8F38-6EEFE5AFA8B8","inputs":[{"id":"44e89480-7af4-11ed-a3f2-95479c4ed5c7","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"44dea320-7af4-11ed-9aca-d916747bcd52","value":"{ $.ListItemsByTagName.item.resourceAttributes.id }","type":"string","structure":[]},{"id":"6e186220-7af4-11ed-9afc-893d3f4375c0","value":"{ $.vRecycleSpace }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"blendr_on_error","value":"ignore","type":"select","displayValue":"Ignore - Continue Automation and ignore errors","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":42,"y":782,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"44cf44b0-7af4-11ed-b608-f76bab847e7a","endpoint_role":"update"},{"id":"E02462CB-0D10-4DEF-8225-68549785D47D","type":"SnippetBlock","disabled":false,"name":"RemoveTagFromItemByName","displayName":"Qlik Platform Operations - Remove Tag From Item By Name","comment":"","childId":"0105BFA6-4709-435A-85F4-8E9FF9A841E2","inputs":[{"id":"41ba0dd0-45aa-11ef-8fde-8f20ff9cb5f7","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"41ba5df0-45aa-11ef-abd4-f37b23da765c","value":"{ $.ListItemsByTagName.item.id }","type":"string","structure":[]},{"id":"41ba9520-45aa-11ef-8139-1d66e45820f2","value":"delete","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":314,"y":1167,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","snippet_guid":"41b59b50-45aa-11ef-a081-6b3284e323b9"},{"id":"0105BFA6-4709-435A-85F4-8E9FF9A841E2","type":"EndpointBlock","disabled":false,"name":"updateApp","displayName":"Qlik Platform Operations - Update App","comment":"","childId":"5983FB5C-92EC-45A3-B261-9C3207760FE1","inputs":[{"id":"7f0c48c0-7af3-11ed-a900-f3507bf41c84","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"8a6bb4a0-91b7-11ed-9ef0-0511687c2273","value":"{ $.ListItemsByTagName.item.resourceAttributes.id }","type":"string","structure":[]},{"id":"7f05c270-7af3-11ed-8d62-c3e13c524f65","value":"{date: 'now + { $.vRecycleTime }', 'd-m-y'} - {$.ListItemsByTagName.item.resourceAttributes.name}","type":"string","structure":[]},{"id":"7f243cc0-7af3-11ed-89e1-93a6412bc15a","value":"{ $.ListItemsByTagName.item.resourceAttributes.description }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":292,"y":1480,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"7efab0d0-7af3-11ed-99b0-cfbf9fbf4990","endpoint_role":"update"},{"id":"DAAEAAC7-091B-48E0-AAF6-F9248DA2BAAB","type":"ShowBlock","disabled":false,"name":"output","displayName":"Output","comment":"Show other Item Types","childId":null,"inputs":[{"id":"input","value":"Other found {$.ListItemsByTagName.item.resourceType}","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":129,"y":1043},{"id":"EBF34D0D-926C-482D-8F67-B36309FD6897","type":"CaseBlock","disabled":false,"name":"case","displayName":"Case","comment":"Check item type, currently only App, Scripts, Data Flows","childId":null,"inputs":[{"id":"expression","value":"{ $.ListItemsByTagName.item.resourceType }","type":"string","structure":[]},{"id":"statements","value":["app","dataset"],"type":"list","mode":"keyValue","structure":[]}],"settings":[],"collapsed":[{"name":"default","isCollapsed":false}],"x":-78,"y":342,"statementChildrenIds":["69DCA474-7D51-43B4-B80D-48BBFAD5E61E","0002B856-1419-490E-AEED-9322DC267008"],"defaultChildId":"DAAEAAC7-091B-48E0-AAF6-F9248DA2BAAB"},{"id":"69DCA474-7D51-43B4-B80D-48BBFAD5E61E","type":"ShowBlock","disabled":false,"name":"output2","displayName":"Output 2","comment":"","childId":"9016BD7C-5315-4098-B53C-EE0C2A76C0DA","inputs":[{"id":"input","value":"App  {$.ListItemsByTagName.item.name}  found for deletion","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-618,"y":26},{"id":"0002B856-1419-490E-AEED-9322DC267008","type":"ShowBlock","disabled":false,"name":"output3","displayName":"Output 3","comment":"dataset currently not implemented","childId":null,"inputs":[{"id":"input","value":"Dataset {$.ListItemsByTagName.item.name} found","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":42,"y":1702},{"id":"B663DC06-DA59-494D-89F8-87A22EA97F96","type":"EndpointBlock","disabled":false,"name":"listItems","displayName":"Qlik Platform Operations - List Items","comment":"Check Recycle Bin Space","childId":null,"inputs":[{"id":"5e0e39f0-e8e9-11ed-a235-bd0d5c4d2a7d","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"5dacfe40-e8e9-11ed-881b-63200467c94e","value":null,"type":"string","structure":[]},{"id":"5df5f3c0-e8e9-11ed-9d3e-c9f4d4df756b","value":"{ $.vRecycleSpace }","type":"string","structure":[]},{"id":"5e15df30-e8e9-11ed-a3f8-cb18adbc30f4","value":null,"type":"string","structure":[]},{"id":"5e0555e0-e8e9-11ed-98f4-6f2549cb2159","value":null,"type":"select","structure":[]},{"id":"abbe1b80-e8ef-11ed-b94c-a7318c3a8be2","value":null,"type":"string","structure":[]},{"id":"4a2febc0-e8f0-11ed-9b5c-e5241d8bd3ff","value":null,"type":"string","structure":[]},{"id":"4da4cf20-e8f3-11ed-a2b2-3d0a759d2c53","value":null,"type":"string","structure":[]},{"id":"6bf47050-e8f3-11ed-ada8-15943bf3383c","value":null,"type":"string","structure":[]},{"id":"8aaacee0-e8f3-11ed-a504-0f903858bba2","value":null,"type":"string","structure":[]},{"id":"a4d8b9d0-e8f3-11ed-800e-d70f72eda0ef","value":null,"type":"select","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"maxitemcount","value":"","type":"string","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"cache","value":"0","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-198,"y":2342,"loopBlockId":"10803C4B-36EC-4C53-9F57-E25CA511EF9E","datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"5d8264a0-e8e9-11ed-bf7e-a7275b075e61","endpoint_role":"list"},{"id":"E6E8C2C3-ECFE-47D6-9A67-96CB47F533F5","type":"VariableBlock","disabled":false,"name":"vRecycleSpace","displayName":"Variable - vRecycleSpace","comment":"Add Space ID used as Recycle Bin","childId":"DB06E43C-2D8A-4D3A-B33D-F7B4F34B3491","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-198,"y":122,"variableGuid":"A8A8103C-2DDB-428B-911B-C42C0EC67E39","operations":[{"id":"set_value","key":"E1C958CE-F506-442B-B971-E392B56826C8","name":"Set value of { variable }","value":"68248b9585aec9342736cde9"}]},{"id":"B4CD9E80-F158-46F8-920B-B4CECD1EBC94","type":"ShowBlock","disabled":false,"name":"output4","displayName":"Output 4","comment":"","childId":null,"inputs":[{"id":"input","value":"{ $.listItems.item.name } Delete","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":42,"y":1522},{"id":"10803C4B-36EC-4C53-9F57-E25CA511EF9E","type":"IfElseBlock","disabled":false,"name":"condition","displayName":"Condition","comment":"Check Items to be deleted, currently only App, Scripts, Data Flows","childId":null,"inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{date: {substr: { $.listItems.item.name }, 0, 8}, 'U', 'd-m-y'}","input2":"{date: 'now', 'U'}","operator":"<"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":22,"y":660,"childTrueId":"9A4F8DC1-5EEC-4D7A-9075-BC8C5FEBC6B7","childFalseId":"41F9971E-BA35-4813-BB24-973734BA506B"},{"id":"41F9971E-BA35-4813-BB24-973734BA506B","type":"ShowBlock","disabled":false,"name":"output5","displayName":"Output 5","comment":"","childId":null,"inputs":[{"id":"input","value":"{ $.listItems.item.name } keep","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":292,"y":1522},{"id":"DB06E43C-2D8A-4D3A-B33D-F7B4F34B3491","type":"VariableBlock","disabled":false,"name":"vRecycleTime","displayName":"Variable - vRecycleTime","comment":"Set Time Item should be kept for example\n7 days\n30 days","childId":"B0969529-9190-4EDB-828A-18C9E773B54C","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-198,"y":242,"variableGuid":"FED093F9-863D-4D6E-8052-8A375DBB7556","operations":[{"id":"set_value","key":"E1C958CE-F506-442B-B971-E392B56826C8","name":"Set value of { variable }","value":"7 days"}]},{"id":"9A4F8DC1-5EEC-4D7A-9075-BC8C5FEBC6B7","type":"EndpointBlock","disabled":false,"name":"deleteApp","displayName":"Qlik Platform Operations - Delete App","comment":"","childId":"B4CD9E80-F158-46F8-920B-B4CECD1EBC94","inputs":[{"id":"90135170-7af2-11ed-9f08-83898fe69c8e","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"8ffab0c0-7af2-11ed-8815-3d11c1ad6c97","value":"{ $.listItems.item.resourceId }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-738,"y":1760,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"8fdd2c60-7af2-11ed-bff4-0d91d2a3f5e0","endpoint_role":"delete"},{"id":"B0969529-9190-4EDB-828A-18C9E773B54C","type":"VariableBlock","disabled":false,"name":"vTenantURL","displayName":"Variable - vTenantURL","comment":"add Tenant URL <name>.<region>.qlikcloud.com","childId":"45E98FD6-6D80-4B2E-9195-BC6A4DC09179","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-198,"y":362,"variableGuid":"B7633D7C-F685-48A1-B455-62EAF6E3C54C","operations":[{"id":"set_value","key":"E1C958CE-F506-442B-B971-E392B56826C8","name":"Set value of { variable }","value":"csetest.eu.qlikcloud.com"}]},{"id":"B8B31F51-3E86-4153-8037-790AC0755E09","type":"SnippetBlock","disabled":false,"name":"AddMemberToSpaceIfNotExisting,UpdateIfExisting","displayName":"Qlik Platform Operations - Add Member To Space If Not Existing,Update If Existing","comment":"Add OAuth User Can Manage Role","childId":"EF0D937E-7541-4139-AD8F-52444F7FDFD8","inputs":[{"id":"8e196e80-d7cd-11ee-9508-3f0b94a3e0fc","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"8e1a6dd0-d7cd-11ee-879c-f50c7bb4d8a7","value":"{ $.ListItemsByTagName.item.spaceId }","type":"string","structure":[]},{"id":"8e1bc610-d7cd-11ee-a121-cbfdce773fbf","value":"6824a015cf2a67b50e84f2ae","type":"string","structure":[]},{"id":"8e1c5890-d7cd-11ee-85d7-93831e0a8ff8","value":"user","type":"select","displayValue":"user","structure":[]},{"id":"8e1d8720-d7cd-11ee-b8ec-951008b8edef","value":"[\"facilitator\"]","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"blendr_on_error","value":"stop","type":"select","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":155,"y":349,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","snippet_guid":"8e0c0530-d7cd-11ee-b08d-a1a8e01d1413"},{"id":"F520A5F5-5966-443F-8F38-6EEFE5AFA8B8","type":"IfElseBlock","disabled":false,"name":"condition2","displayName":"Condition 2","comment":"Check if Move failed ","childId":"E02462CB-0D10-4DEF-8225-68549785D47D","inputs":[{"id":"conditions","value":{"mode":"all","conditions":[{"input1":"{ $.state.moveApp.error.response.status}","operator":"=","input2":"403"}]},"type":"custom","structure":[]}],"settings":[],"collapsed":[{"name":"both","isCollapsed":false},{"name":"yes","isCollapsed":false},{"name":"no","isCollapsed":false}],"x":292,"y":1000,"childTrueId":"53325397-D5D1-4C65-BC00-84C585304BBC","childFalseId":null},{"id":"EF0D937E-7541-4139-AD8F-52444F7FDFD8","type":"EndpointBlock","disabled":false,"name":"moveApp2","displayName":"Qlik Platform Operations - Move App 2","comment":"","childId":null,"inputs":[{"id":"44e89480-7af4-11ed-a3f2-95479c4ed5c7","value":"{ $.vTenantURL }","type":"string","structure":[]},{"id":"44dea320-7af4-11ed-9aca-d916747bcd52","value":"{ $.ListItemsByTagName.item.resourceAttributes.id }","type":"string","structure":[]},{"id":"6e186220-7af4-11ed-9afc-893d3f4375c0","value":"{ $.vRecycleSpace }","type":"string","structure":[]}],"settings":[{"id":"datasource","value":"27e6c007-0b56-4a38-b324-10bd7ef46169","type":"select","structure":[]},{"id":"blendr_on_error","value":"warning","type":"select","displayValue":"Warning - Continue Automation and report errors","structure":[]},{"id":"automations_censor_data","value":false,"type":"checkbox","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":292,"y":782,"datasourcetype_guid":"c7e48240-e0f2-11ec-ada1-d5ef75014b77","endpoint_guid":"44cf44b0-7af4-11ed-b608-f76bab847e7a","endpoint_role":"update"},{"id":"53325397-D5D1-4C65-BC00-84C585304BBC","type":"ShowBlock","disabled":false,"name":"output6","displayName":"Output 6","comment":"","childId":"B8B31F51-3E86-4153-8037-790AC0755E09","inputs":[{"id":"input","value":"No Access for Automation User, assign Role","type":"string","structure":{}}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":{}}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":-501,"y":314},{"id":"5983FB5C-92EC-45A3-B261-9C3207760FE1","type":"ShowBlock","disabled":false,"name":"output7","displayName":"Output 7","comment":"","childId":null,"inputs":[{"id":"input","value":"App {$.ListItemsByTagName.item.name} moved to Recycle Bin","type":"string","structure":[]}],"settings":[{"id":"display_mode","value":"add","type":"select","structure":[]}],"collapsed":[{"name":"loop","isCollapsed":false}],"x":292,"y":1702},{"id":"45E98FD6-6D80-4B2E-9195-BC6A4DC09179","type":"VariableBlock","disabled":false,"name":"vOAuthUserID","displayName":"Variable - vOAuthUserID","comment":"Add the User ID for the OAuth Client to ensure access. ","childId":"85ADC559-CC8F-40BD-9859-8C3A490A4907","inputs":[],"settings":[],"collapsed":[{"name":"loop","isCollapsed":false}],"x":52,"y":362,"variableGuid":"1D22DB34-1F9E-4009-B9C5-FF4BBE5409D5","operations":[{"id":"set_value","key":"E1C958CE-F506-442B-B971-E392B56826C8","name":"Set value of { variable }","value":"6824a015cf2a67b50e84f2ae"}]}],"variables":[{"guid":"A8A8103C-2DDB-428B-911B-C42C0EC67E39","name":"vRecycleSpace","type":"string"},{"guid":"FED093F9-863D-4D6E-8052-8A375DBB7556","name":"vRecycleTime","type":"string"},{"guid":"B7633D7C-F685-48A1-B455-62EAF6E3C54C","name":"vTenantURL","type":"string"},{"guid":"1D22DB34-1F9E-4009-B9C5-FF4BBE5409D5","name":"vOAuthUserID","type":"string"}]}